"use strict";(self.webpackChunknabd=self.webpackChunknabd||[]).push([[730],{730:(tt,U,n)=>{n.r(U),n.d(U,{UsersModule:()=>k});var r=n(1180),p=n(6814),c=n(2787),t=n(5879),l=n(5313),f=n(3365),M=n(7921),N=n(4664),F=n(6306),I=n(2096),S=n(7398),E=n(553),J=n(9862);let v=(()=>{var o;class a{constructor(e){(0,r.Z)(this,"http",void 0),(0,r.Z)(this,"baseUrl",E.N.users),this.http=e}getUsers(e,u){return this.http.get(`${this.baseUrl}?pageNo=${e}&pageSize=${u}&sortBy=name`)}editUser(e,u){return this.http.put(`${this.baseUrl}/${e}`,u)}}return o=a,(0,r.Z)(a,"\u0275fac",function(e){return new(e||o)(t.LFG(J.eN))}),(0,r.Z)(a,"\u0275prov",t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})),a})();var Q=n(1933),C=n(7700),R=n(4698),h=n(2296),x=n(617),A=n(6007);function Y(o,a){1&o&&(t.TgZ(0,"th",18),t._uU(1," \u0627\u0633\u0645 \u0627\u0644\u0645\u0633\u062a\u062e\u062f\u0645"),t.qZA())}function w(o,a){if(1&o&&(t.TgZ(0,"td",19),t._uU(1),t.qZA()),2&o){const s=a.$implicit;t.xp6(1),t.hij(" ",s.name," ")}}function D(o,a){1&o&&(t.TgZ(0,"th",18),t._uU(1,"\u0627\u0644\u0627\u064a\u0645\u064a\u0644"),t.qZA())}function L(o,a){if(1&o&&(t.TgZ(0,"td",19),t._uU(1),t.qZA()),2&o){const s=a.$implicit;t.xp6(1),t.hij(" ",s.email," ")}}function z(o,a){1&o&&(t.TgZ(0,"th",18),t._uU(1," \u0625\u062c\u0631\u0627\u0621\u0627\u062a"),t.qZA())}function O(o,a){if(1&o){const s=t.EpF();t.TgZ(0,"td",19)(1,"div",20)(2,"a",21),t.NdJ("click",function(){const m=t.CHM(s).$implicit,Z=t.oxw();return t.KtG(Z.editUser(m))}),t.TgZ(3,"button",22)(4,"span",3),t._UZ(5,"mat-icon",4),t._uU(6," \u062a\u0639\u062f\u064a\u0644 "),t.qZA()()(),t.TgZ(7,"button",23),t.NdJ("click",function(){const m=t.CHM(s).$implicit,Z=t.oxw();return t.KtG(Z.deleteUser(m.id))}),t.TgZ(8,"span",3),t._UZ(9,"mat-icon",24),t._uU(10," \u062d\u0630\u0641 "),t.qZA()()()()}}function $(o,a){1&o&&t._UZ(0,"tr",25)}function j(o,a){1&o&&t._UZ(0,"tr",26)}function G(o,a){1&o&&t._UZ(0,"mat-progress-bar",27)}const B=function(){return[10,25,100]};let q=(()=>{var o;class a{constructor(e,u){(0,r.Z)(this,"dialog",void 0),(0,r.Z)(this,"toast",void 0),(0,r.Z)(this,"displayedColumns",["name","email","action"]),(0,r.Z)(this,"dataSource",new l.by([])),(0,r.Z)(this,"paginator",void 0),(0,r.Z)(this,"totalElements",10),(0,r.Z)(this,"isLoading",!0),(0,r.Z)(this,"userService",(0,t.f3M)(v)),(0,r.Z)(this,"router",(0,t.f3M)(c.F0)),(0,r.Z)(this,"activeRouter",(0,t.f3M)(c.gz)),this.dialog=e,this.toast=u}ngAfterViewInit(){this.dataSource.paginator=this.paginator,this.paginator.page.pipe((0,M.O)({}),(0,N.w)(()=>(this.isLoading=!0,this.userService.getUsers(this.paginator.pageIndex,this.paginator.pageSize).pipe((0,F.K)(()=>(0,I.of)(null))))),(0,S.U)(e=>null==e?[]:(this.totalElements=e.totalElements,this.isLoading=!1,e.data))).subscribe(e=>{this.dataSource=new l.by(e)})}editUser(e){this.router.navigate(["../edit/"+e.id],{state:{user:e},relativeTo:this.activeRouter})}deleteUser(e){this.dialog.open(Q.h,{disableClose:!0,data:{message:`\u0647\u0644 \u0627\u0646\u062a \u0645\u062a\u0627\u0643\u062f \u0627\u0646\u0643 \u062a\u0631\u064a\u062f \u062d\u0630\u0641 \u0627\u0644\u0645\u0633\u062a\u062e\u062f\u0645 ${e.name} \u061f `}}).afterClosed().subscribe(m=>{this.toast.success("\u062a\u0645 \u062d\u0630\u0641 \u0627\u0644\u0645\u0633\u062a\u062e\u062f\u0645",{duration:5e3,position:"top-right",theme:"snackbar"})})}}return o=a,(0,r.Z)(a,"\u0275fac",function(e){return new(e||o)(t.Y36(C.uw),t.Y36(R.jE))}),(0,r.Z)(a,"\u0275cmp",t.Xpm({type:o,selectors:[["app-users-management"]],viewQuery:function(e,u){if(1&e&&t.Gf(f.NW,5),2&e){let m;t.iGM(m=t.CRH())&&(u.paginator=m.first)}},decls:24,vars:8,consts:[[1,"text-2xl","border-r-4","border-r-primary-500","font-bold","text-primary-500","mr-5","pr-2","mb-8","mt-20"],["routerLink","../create"],["mat-raised-button","","color","primary",1,"mt-10","mr-auto","!block","ml-10"],[1,"flex","gap-2.5"],["aria-hidden","false","fontIcon","edit"],[1,"mt-10","px-10"],[1,"mat-elevation-z8","w-full"],[1,"overflow-x-auto"],["mat-table","",1,"rounded-lg",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","email"],["matColumnDef","action"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mode","indeterminate",4,"ngIf"],[3,"length","pageSize","pageSizeOptions"],["mat-header-cell",""],["mat-cell",""],[1,"gap-3.5","flex"],[3,"click"],["mat-raised-button","","color","primary"],["mat-raised-button","","color","warn",3,"click"],["aria-hidden","false","fontIcon","delete"],["mat-header-row",""],["mat-row",""],["mode","indeterminate"]],template:function(e,u){1&e&&(t.TgZ(0,"h3",0),t._uU(1,"\u0625\u062f\u0627\u0631\u0629 \u0627\u0644\u0645\u0633\u062a\u062e\u062f\u0645\u064a\u0646"),t.qZA(),t.TgZ(2,"a",1)(3,"button",2)(4,"span",3),t._UZ(5,"mat-icon",4),t._uU(6," \u0625\u0636\u0627\u0641\u0629 \u0645\u0633\u062a\u062e\u062f\u0645 "),t.qZA()()(),t.TgZ(7,"div",5)(8,"div",6)(9,"div",7)(10,"table",8),t.ynx(11,9),t.YNc(12,Y,2,0,"th",10),t.YNc(13,w,2,1,"td",11),t.BQk(),t.ynx(14,12),t.YNc(15,D,2,0,"th",10),t.YNc(16,L,2,1,"td",11),t.BQk(),t.ynx(17,13),t.YNc(18,z,2,0,"th",10),t.YNc(19,O,11,0,"td",11),t.BQk(),t.YNc(20,$,1,0,"tr",14),t.YNc(21,j,1,0,"tr",15),t.qZA()(),t.YNc(22,G,1,0,"mat-progress-bar",16),t._UZ(23,"mat-paginator",17),t.qZA()()),2&e&&(t.xp6(10),t.Q6J("dataSource",u.dataSource),t.xp6(10),t.Q6J("matHeaderRowDef",u.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",u.displayedColumns),t.xp6(1),t.Q6J("ngIf",u.isLoading),t.xp6(1),t.Q6J("length",u.totalElements)("pageSize",10)("pageSizeOptions",t.DdM(7,B)))},dependencies:[p.O5,c.rH,h.lW,x.Hw,f.NW,A.pW,l.BZ,l.fO,l.as,l.w1,l.Dz,l.nj,l.ge,l.ev,l.XQ,l.Gk],encapsulation:2})),a})();var i=n(6223),H=n(304),g=n(2032),d=n(9157),T=n(8525),W=n(3680);function X(o,a){if(1&o&&(t.TgZ(0,"mat-option",14),t._uU(1),t.qZA()),2&o){const s=a.$implicit;t.Q6J("value",s.type),t.xp6(1),t.hij(" ",s.text," ")}}function K(o,a){if(1&o&&(t.TgZ(0,"mat-option",14),t._uU(1),t.qZA()),2&o){const s=a.$implicit;t.Q6J("value",s.id),t.xp6(1),t.hij(" ",s.locationName," ")}}function V(o,a){if(1&o&&(t.TgZ(0,"mat-form-field",4)(1,"mat-label"),t._uU(2,"\u0627\u0644\u0645\u0646\u0627\u0637\u0642"),t.qZA(),t.TgZ(3,"mat-select",15),t.YNc(4,K,2,2,"mat-option",8),t.qZA()()),2&o){const s=t.oxw();t.xp6(4),t.Q6J("ngForOf",s.locations)}}let b=(()=>{var o;class a{constructor(e){(0,r.Z)(this,"fb",void 0),(0,r.Z)(this,"createUser",void 0),(0,r.Z)(this,"userTypes",[{type:"ROLE_NU",text:"\u0645\u0633\u062a\u062e\u062f\u0645"},{type:"ROLE_AU",text:"\u0627\u062f\u0645\u0646"},{type:"ROLE_SU",text:"\u0645\u0633\u0626\u0648\u0644"}]),(0,r.Z)(this,"locations",[]),(0,r.Z)(this,"route",(0,t.f3M)(c.gz)),(0,r.Z)(this,"router",(0,t.f3M)(c.F0)),(0,r.Z)(this,"authService",(0,t.f3M)(H.e)),(0,r.Z)(this,"userService",(0,t.f3M)(v)),this.fb=e,this.createUser=this.fb.group({name:["",[i.kI.required]],password:[""],roles:["",[i.kI.required]],phoneNumber:["",[i.kI.required]],email:["",[i.kI.required]],locationListId:[[],[i.kI.required]]})}ngOnInit(){this.route.data.subscribe(e=>{this.locations=e.locations.data,console.log(this.locations)}),this.router.url.includes("create")&&this.createUser.get("password")?.setValidators(i.kI.required),window.history.state.user&&this.setForm(window.history.state.user)}setForm(e){this.createUser.patchValue({name:e.name,roles:e.roles,phoneNumber:e.phoneNumber,email:e.email,locationListId:e.locations})}submit(){this.router.url.includes("create")?this.authService.register(this.createUser.value).subscribe(e=>{}):(""===this.createUser.value.password&&delete this.createUser.value.password,this.userService.editUser(this.route.snapshot.paramMap.get("id"),this.createUser.value).subscribe(e=>{this.router.navigate(["/users"])}))}}return o=a,(0,r.Z)(a,"\u0275fac",function(e){return new(e||o)(t.Y36(i.qu))}),(0,r.Z)(a,"\u0275cmp",t.Xpm({type:o,selectors:[["app-create-user"]],decls:30,vars:5,consts:[[1,"text-2xl","border-r-4","border-r-primary-500","font-bold","text-primary-500","mr-5","pr-2","mb-8","mt-20"],[3,"formGroup"],[1,"flex","px-4","pb-4"],[1,"flex","flex-col","gap-3.5","basis-1/2","w-1/2","lg:pl-36","pl-4"],["appearance","outline"],["matInput","","formControlName","name"],["matInput","","formControlName","password"],["formControlName","roles"],[3,"value",4,"ngFor","ngForOf"],[1,"flex","flex-col","gap-3.5","basis-1/2","w-1/2","lg:pr-36","pr-4"],["matInput","","formControlName","phoneNumber"],["matInput","","formControlName","email"],["appearance","outline",4,"ngIf"],["type","submit","mat-raised-button","","color","primary",1,"mx-auto","!block","text-2xl","!px-6","!py-4","!rounded-2xl","!h-auto","font-bold",3,"click"],[3,"value"],["formControlName","locationListId","multiple",""]],template:function(e,u){if(1&e&&(t.TgZ(0,"h3",0),t._uU(1),t.qZA(),t.TgZ(2,"form",1)(3,"div",2)(4,"div",3)(5,"mat-form-field",4)(6,"mat-label"),t._uU(7,"\u0627\u0633\u0645 \u0627\u0644\u0645\u0633\u062a\u062e\u062f\u0645"),t.qZA(),t._UZ(8,"input",5),t.qZA(),t.TgZ(9,"mat-form-field",4)(10,"mat-label"),t._uU(11,"\u0643\u0644\u0645\u0629 \u0627\u0644\u0633\u0631"),t.qZA(),t._UZ(12,"input",6),t.qZA(),t.TgZ(13,"mat-form-field",4)(14,"mat-label"),t._uU(15,"\u0646\u0648\u0639 \u0627\u0644\u0645\u0633\u062a\u062e\u062f\u0645"),t.qZA(),t.TgZ(16,"mat-select",7),t.YNc(17,X,2,2,"mat-option",8),t.qZA()()(),t.TgZ(18,"div",9)(19,"mat-form-field",4)(20,"mat-label"),t._uU(21,"\u0631\u0642\u0645 \u0627\u0644\u0647\u0627\u062a\u0641"),t.qZA(),t._UZ(22,"input",10),t.qZA(),t.TgZ(23,"mat-form-field",4)(24,"mat-label"),t._uU(25,"\u0627\u0644\u0627\u064a\u0645\u064a\u0644"),t.qZA(),t._UZ(26,"input",11),t.qZA(),t.YNc(27,V,5,1,"mat-form-field",12),t.qZA()(),t.TgZ(28,"button",13),t.NdJ("click",function(){return u.submit()}),t._uU(29),t.qZA()()),2&e){let m;t.xp6(1),t.hij("\u0645\u0633\u062a\u062e\u062f\u0645 ",u.router.url.includes("create")?"\u062c\u0640\u062f\u064a\u062f":"",""),t.xp6(1),t.Q6J("formGroup",u.createUser),t.xp6(15),t.Q6J("ngForOf",u.userTypes),t.xp6(10),t.Q6J("ngIf","ROLE_NU"===(null==(m=u.createUser.get("roles"))?null:m.value)),t.xp6(2),t.hij(" ",u.router.url.includes("create")?"\u0625\u0636\u0627\u0641\u0629":"\u062a\u0639\u062f\u064a\u0644"," \u0645\u0633\u062a\u062e\u062f\u0645 ")}},dependencies:[p.sg,p.O5,g.Nt,d.KE,d.hX,T.gD,W.ey,h.lW,i._Y,i.Fj,i.JJ,i.JL,i.sg,i.u],encapsulation:2})),a})();var y=n(3570);const _=[{path:"",pathMatch:"full",redirectTo:"management"},{path:"management",component:q},{path:"create",component:b,resolve:{locations:y.G}},{path:"edit/:id",component:b,resolve:{locations:y.G}}];let P=(()=>{var o;class a{}return o=a,(0,r.Z)(a,"\u0275fac",function(e){return new(e||o)}),(0,r.Z)(a,"\u0275mod",t.oAB({type:o})),(0,r.Z)(a,"\u0275inj",t.cJS({imports:[c.Bz.forChild(_),c.Bz]})),a})(),k=(()=>{var o;class a{}return o=a,(0,r.Z)(a,"\u0275fac",function(e){return new(e||o)}),(0,r.Z)(a,"\u0275mod",t.oAB({type:o})),(0,r.Z)(a,"\u0275inj",t.cJS({imports:[p.ez,P,g.c,d.lN,T.LD,h.ot,x.Ps,f.TU,A.Cv,l.p0,C.Is,i.u5,i.UX,d.lN,g.c]})),a})()}}]);